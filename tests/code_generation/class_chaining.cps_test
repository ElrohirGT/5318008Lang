class Color {
  let r: integer;
  let g: integer;
  let b: integer;

  function WithR(r: integer): Color {
      this.r = r;
      return this;
  }

  function WithG(g: integer): Color {
    this.g = g;
    return this;
  }

  function WithB(b: integer): Color {
    this.b = b;
    return this;
  }

  function ToArray(buffer: integer[]) {
    buffer[0] = this.r;
    buffer[1] = this.g;
    buffer[2] = this.b;
  }
}

let color = new Color();
let buffer = [0,0,0];
color
  .WithR(100)
  .WithG(100)
  .WithB(100)
  .ToArray(buffer);
---
# Code generated by 5318008Lang compiler.
# Checkout our repository here: https://github.com/ElrohirGT/5318008Lang
# The following code is designed to run on the compiler: https://cpulator.01xz.net/?sys=mipsr5-spim
.data
panic_prefix:		.asciiz		"panic: "
zero_division_exception:		.asciiz		"division by zero"
idx_out_of_range_exception:		.asciiz		"idx out of range"
err_pointer:		.word		0

.text
# Main start of our program
.global _start
_start:
	jal main
	li $v0, 10
	syscall		# Use syscall 10 to stop simulation

main:
	addiu $sp, $sp, -44
# ALLOC t25 12
	la $t0, 4($sp)
	sw $t0, 0($sp)
# // this
# PARAM t25
	lw $t0, 0($sp)
	sw $s0, 16($sp)
	move $s0, $t0
# // newColor()
# CALL Color_constructor 1
	sw $ra, 40($sp)
	jal Color_constructor
	lw $ra, 40($sp)
	lw $s0, 16($sp)
# ALLOC t26 12
	la $t0, 20($sp)
	sw $t0, 16($sp)
# SWO t26 0 0
	li $t0, 0
	li $t1, 0
	lw $t2, 16($sp)
	addu $t2, $t2, $t0
	sw $t1, 0($t2)
# SWO t26 4 0
	li $t0, 4
	li $t1, 0
	lw $t2, 16($sp)
	addu $t2, $t2, $t0
	sw $t1, 0($t2)
# SWO t26 8 0
	li $t0, 8
	li $t1, 0
	lw $t2, 16($sp)
	addu $t2, $t2, $t0
	sw $t1, 0($t2)
# // this -> color
# PARAM t25
	lw $t0, 0($sp)
	sw $s0, 32($sp)
	move $s0, $t0
# PARAM 100
	li $t0, 100
	sw $s1, 36($sp)
	move $s1, $t0
# // color.WithR(100)
# CALLRET t27 Color_WithR 2
	sw $ra, 40($sp)
	jal Color_WithR
	move $t0, $v0
	lw $ra, 40($sp)
	lw $s0, 32($sp)
	lw $s1, 36($sp)
# // this -> color.WithR(100)
# PARAM t27
	sw $s0, 32($sp)
	move $s0, $t0
# PARAM 100
	li $t0, 100
	sw $s1, 36($sp)
	move $s1, $t0
# // color.WithR(100).WithG(100)
# CALLRET t28 Color_WithG 2
	sw $ra, 40($sp)
	jal Color_WithG
	move $t0, $v0
	lw $ra, 40($sp)
	lw $s0, 32($sp)
	lw $s1, 36($sp)
# // this -> color.WithR(100).WithG(100)
# PARAM t28
	sw $s0, 32($sp)
	move $s0, $t0
# PARAM 100
	li $t0, 100
	sw $s1, 36($sp)
	move $s1, $t0
# // color.WithR(100).WithG(100).WithB(100)
# CALLRET t29 Color_WithB 2
	sw $ra, 40($sp)
	jal Color_WithB
	move $t0, $v0
	lw $ra, 40($sp)
	lw $s0, 32($sp)
	lw $s1, 36($sp)
# // this -> color.WithR(100).WithG(100).WithB(100)
# PARAM t29
	sw $s0, 32($sp)
	move $s0, $t0
# // buffer
# PARAM t26
	lw $t0, 16($sp)
	sw $s1, 36($sp)
	move $s1, $t0
# // color.WithR(100).WithG(100).WithB(100).ToArray(buffer)
# CALL Color_ToArray 2
	sw $ra, 40($sp)
	jal Color_ToArray
	lw $ra, 40($sp)
	lw $s0, 32($sp)
	lw $s1, 36($sp)
# END
	addiu $sp, $sp, 44
	jr $ra
# 
# FUNC Color_ToArray:
Color_ToArray:
	addiu $sp, $sp, -16
# 	// this
# 	LOAD t17
# 	// buffer
# 	LOAD t18
# 	LWO t19 t17 0
	li $t0, 0
	move $t2, $s0
	addu $t2, $t2, $t0
	lw $t1, 0($t2)
# 	ADD t20 0 0
	li $t0, 0
	li $t2, 0
	add $t3, $t0, $t2
# 	ADD t20 t20 0
	li $t0, 0
	add $t2, $t3, $t0
# 	SWO t18 t20 t19
	move $t3, $s1
	addu $t3, $t3, $t2
	sw $t1, 0($t3)
# 	LWO t21 t17 4
	li $t2, 4
	move $t3, $s0
	addu $t3, $t3, $t2
	lw $t1, 0($t3)
# 	ADD t22 0 0
	li $t2, 0
	li $t3, 0
	add $t0, $t2, $t3
# 	ADD t22 t22 4
	li $t2, 4
	add $t3, $t0, $t2
# 	SWO t18 t22 t21
	move $t0, $s1
	addu $t0, $t0, $t3
	sw $t1, 0($t0)
# 	LWO t23 t17 8
	li $t3, 8
	move $t0, $s0
	addu $t0, $t0, $t3
	lw $t1, 0($t0)
# 	ADD t24 0 0
	li $t3, 0
	li $t0, 0
	add $t2, $t3, $t0
# 	ADD t24 t24 8
	li $t3, 8
	add $t0, $t2, $t3
# 	SWO t18 t24 t23
	move $t2, $s1
	addu $t2, $t2, $t0
	sw $t1, 0($t2)
# 	END
	addiu $sp, $sp, 16
	jr $ra
# FUNC Color_WithB:
Color_WithB:
	addiu $sp, $sp, -20
# 	// this
# 	LOAD t14
# 	// b
# 	LOAD t15
# 	= t16 i32 8
	li $t0, 8
	sw $t0, 0($sp)
# 	SWO t14 t16 t15
	lw $t0, 0($sp)
	move $t1, $s0
	addu $t1, $t1, $t0
	sw $s1, 0($t1)
# 	RETURN t14
	move $v0, $s0
	addiu $sp, $sp, 20
	jr $ra
# 	END
	addiu $sp, $sp, 20
	jr $ra
# FUNC Color_WithG:
Color_WithG:
	addiu $sp, $sp, -20
# 	// this
# 	LOAD t11
# 	// g
# 	LOAD t12
# 	= t13 i32 4
	li $t0, 4
	sw $t0, 0($sp)
# 	SWO t11 t13 t12
	lw $t0, 0($sp)
	move $t1, $s0
	addu $t1, $t1, $t0
	sw $s1, 0($t1)
# 	RETURN t11
	move $v0, $s0
	addiu $sp, $sp, 20
	jr $ra
# 	END
	addiu $sp, $sp, 20
	jr $ra
# FUNC Color_WithR:
Color_WithR:
	addiu $sp, $sp, -20
# 	// this
# 	LOAD t8
# 	// r
# 	LOAD t9
# 	= t10 i32 0
	li $t0, 0
	sw $t0, 0($sp)
# 	SWO t8 t10 t9
	lw $t0, 0($sp)
	move $t1, $s0
	addu $t1, $t1, $t0
	sw $s1, 0($t1)
# 	RETURN t8
	move $v0, $s0
	addiu $sp, $sp, 20
	jr $ra
# 	END
	addiu $sp, $sp, 20
	jr $ra
# FUNC Color_constructor:
Color_constructor:
	addiu $sp, $sp, -24
# 	// this
# 	LOAD t1
# 	ADD t2 0 0
	li $t0, 0
	li $t1, 0
	add $t2, $t0, $t1
# 	= t3 i32 0
	li $t0, 0
	sw $t0, 0($sp)
# 	ADD t4 0 4
	li $t0, 0
	li $t1, 4
	add $t3, $t0, $t1
# 	= t5 i32 0
	li $t0, 0
	sw $t0, 4($sp)
# 	ADD t6 0 8
	li $t0, 0
	li $t1, 8
	add $t4, $t0, $t1
# 	= t7 i32 0
	li $t0, 0
	sw $t0, 8($sp)
# 	END
	addiu $sp, $sp, 24
	jr $ra

_EXCEPTION_HANDLER:
	la   $a0, panic_prefix
	li   $v0, 4
	syscall

	lw   $a0, err_pointer
	li   $v0, 4
	syscall

	li   $a0, 10
	li   $v0, 11
	syscall

	li   $v0, 10
	syscall