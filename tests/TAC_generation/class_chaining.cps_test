class Color {
  let r: integer;
  let g: integer;
  let b: integer;

  function WithR(r: integer): Color {
      this.r = r;
      return this;
  }

  function WithG(g: integer): Color {
    this.g = g;
    return this;
  }

  function WithB(b: integer): Color {
    this.b = b;
    return this;
  }

  function ToArray(buffer: integer[]) {
    buffer[0] = this.r;
    buffer[1] = this.g;
    buffer[2] = this.b;
  }
}

let color = new Color();
let buffer = [0,0,0];
color
  .WithR(100)
  .WithG(100)
  .WithB(100)
  .ToArray(buffer);
---
ALLOC t19 12
// this
PARAM t19
// newColor()
CALL Color_constructor 1
ALLOC t20 12
SWO t20 0 0
SWO t20 4 0
SWO t20 8 0
// this -> color
PARAM t19
PARAM 100
// color.WithR(100)
CALLRET t21 Color_WithR 2
// this -> color.WithR(100)
PARAM t21
PARAM 100
// color.WithR(100).WithG(100)
CALLRET t22 Color_WithG 2
// this -> color.WithR(100).WithG(100)
PARAM t22
PARAM 100
// color.WithR(100).WithG(100).WithB(100)
CALLRET t23 Color_WithB 2
// this -> color.WithR(100).WithG(100).WithB(100)
PARAM t23
// buffer
PARAM t20
// color.WithR(100).WithG(100).WithB(100).ToArray(buffer)
CALL Color_ToArray 2
END

FUNC Color_ToArray:
	// this
	LOAD t11
	// buffer
	LOAD t12
	LWO t13 t11 0
	= t14 u32 0
	ADD t14 t14 0
	SWO t12 t14 t13
	LWO t15 t11 4
	= t16 u32 0
	ADD t16 t16 4
	SWO t12 t16 t15
	LWO t17 t11 8
	= t18 u32 0
	ADD t18 t18 8
	SWO t12 t18 t17
	END
FUNC Color_WithB:
	// this
	LOAD t8
	// b
	LOAD t9
	= t10 i32 8
	SWO t8 t10 t9
	RETURN t8
	END
FUNC Color_WithG:
	// this
	LOAD t5
	// g
	LOAD t6
	= t7 i32 4
	SWO t5 t7 t6
	RETURN t5
	END
FUNC Color_WithR:
	// this
	LOAD t2
	// r
	LOAD t3
	= t4 i32 0
	SWO t2 t4 t3
	RETURN t2
	END
FUNC Color_constructor:
	// this
	LOAD t1
	SWO t1 0 0
	SWO t1 4 0
	SWO t1 8 0
	END